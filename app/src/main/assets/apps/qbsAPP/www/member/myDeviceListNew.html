<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta name="HandheldFriendly" content="true"/>
		<meta name="MobileOptimized" content="320"/>
		<title>蓝牙设备检测</title>
		<!--标准mui.css-->
		<link rel="stylesheet" href="../css/mui.min.css">
		<!--App自定义的css-->
		<link rel="stylesheet" type="text/css" href="../css/app.css" />
		<link href="../css/mui.picker.min.css" rel="stylesheet" />
		<link href="../css/mui.poppicker.css" rel="stylesheet" />

		<link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8"/>
		
		<style>
			.mui-btn {
				font-size: 16px;
				padding: 8px;
				margin: 3px;
			}
			h5.mui-content-padded {
				margin-left: 3px;
				margin-top: 20px !important;
			}
			h5.mui-content-padded:first-child {
				margin-top: 12px !important;
			}
			.ui-alert {
				text-align: center;
				padding: 20px 10px;
				font-size: 16px;
			}
		</style>
		
		
		
		
		
		
		<script type="text/javascript" src="../js/common.js"></script>
		<script src="../js/mui.min.js"></script>
		<script src="../js/mui.picker.min.js"></script>
		<script src="../js/mui.poppicker.js"></script>
		
<script type="text/javascript">
var username = localStorage.getItem("username");
var tokenLogin = localStorage.getItem("tokenLogin");
if (username == null || username=="") {
clicked('../Login.html',true)
}


        (function($, doc) {
				$.init();
				$.ready(function() {


					 //蓝牙设备连接列表选择
					var devicePicker = new $.PopPicker({
						layer: 2
					});
					var deviceData = [{
						value: '0',
						text: 'OTC',
						children: [{
							value: "0",
							text: "血糖"
						}, {
							value: "1",
							text: "血压"
						}, {
							value: "2",
							text: "体温"
						}, {
							value: "3",
							text: "血氧"
						}, {
							value: "4",
							text: "血脂",
						}, {
							value: "5",
							text: "体重",
						}, {
							value: "6",
							text: "尿酸",
						}]
					},{
						value: '1',
						text: '乐心',
						children: [{
							value: "0",
							text: "血压计"
						}, {
							value: "1",
							text: "脂肪秤"
						}, {
							value: "2",
							text: "体重秤"
						}, {
							value: "3",
							text: "体重秤"
						}, {
							value: "4",
							text: "计步器",
						}, {
							value: "5",
							text: "厨房秤",
						}]
					}
					]
					devicePicker.setData(deviceData);
					var showDevicePickerButton = doc.getElementById('showDevicePicker');
					var deviceResult = doc.getElementById('deviceResult');
					showDevicePickerButton.addEventListener('tap', function(event) {
						devicePicker.show(function(items) {

							deviceResult.innerText = "你选择的蓝牙设备是:" + items[0].text + " " + items[1].text;
							var Intent = plus.android.importClass("android.content.Intent");
				            var Bundle = plus.android.importClass("android.os.Bundle");
				            var main = plus.android.runtimeMainActivity();
				            var TodoActivity =plus.android.importClass("com.cnnet.otc.health.activities.DetectBle3Activity");

							switch (items[0].value) {
							    case "0":
							        //OTC设备
							        TodoActivity = plus.android.importClass("com.cnnet.otc.health.activities.DetectBle3Activity");
						           //血氧蓝牙4.0设备
						           if(items[1].value =='0'){
						             TodoActivity = plus.android.importClass("com.cnnet.otc.health.activities.DetectBle2Activity");
						           }
						           if(items[1].value =='3'){
						             TodoActivity = plus.android.importClass("com.cnnet.otc.health.activities.DetectBle4Activity");
						           }
							       break;
							    case "1":
							        //乐心
							        TodoActivity = plus.android.importClass("com.foxchen.qbs.health.activities.LSBlueAddSyncActivity");
							        break;
							    default:
							        // ...
							}

				           var intent = new Intent(main, TodoActivity.class);
						   var bundle = new Bundle();
						   //传设备类型和会员号
						   bundle.putString("DEIVCE_TYPE",items[1].value);
						   bundle.putString("EXTRA_MEMBER_UNIQUEKEY",username);
				           intent.putExtras(bundle);
							main.startActivity(intent);

							//返回 false 可以阻止选择框的关闭
							//return true;
						});
					}, false);


					 //WIfi设备连接列表选择
				    var wifiDevicePicker = new $.PopPicker({
						layer: 2
					});
					var wifiDeviceData = [{
						value: '0',
						text: '乐心',
						children: [{
							value: "0",
							text: "血压计-i5/i5s"
						}, {
							value: "1",
							text: "体重秤"
						}]
					}];
					wifiDevicePicker.setData(wifiDeviceData);
					var showWifiDevicePickerButton = doc.getElementById('showWifiDevicePicker');
					var wifiDeviceResult = doc.getElementById('wifiDeviceResult');
					showWifiDevicePickerButton.addEventListener('tap', function(event) {
						wifiDevicePicker.show(function(items) {

							wifiDeviceResult.innerText = "你选择的wifi设备是:" + items[0].text + " " + items[1].text;
							var Intent = plus.android.importClass("android.content.Intent");
				            var Bundle = plus.android.importClass("android.os.Bundle");
				            var main = plus.android.runtimeMainActivity();
				            var TodoActivity =plus.android.importClass("com.foxchen.qbs.health.activities.DetectWifiGuideActivity");

							switch (items[0].value) {
							    case "0":
							        //乐心设备
							        TodoActivity = plus.android.importClass("com.foxchen.qbs.health.activities.DetectWifiGuideActivity");

							       break;

							    default:
							        // ...
							}

				           var intent = new Intent(main, TodoActivity.class);
						   var bundle = new Bundle();
						   //传设备类型和会员号
						   bundle.putString("DEIVCE_TYPE",items[1].value);
						   bundle.putString("EXTRA_MEMBER_UNIQUEKEY",username);
				           intent.putExtras(bundle);
							main.startActivity(intent);

							//返回 false 可以阻止选择框的关闭
							//return true;
						});
					}, false);
				});
			})(mui, document);

  		
        function startActivity(type)
        {
           var Intent = plus.android.importClass("android.content.Intent");
           var Bundle = plus.android.importClass("android.os.Bundle");
           var main = plus.android.runtimeMainActivity();
           var TodoActivity = plus.android.importClass("com.cnnet.otc.health.activities.DetectBle3Activity");
           //血氧蓝牙4.0设备
           if(type=='0'){
             TodoActivity = plus.android.importClass("com.cnnet.otc.health.activities.DetectBle2Activity");
           }
           if(type=='3'){
             TodoActivity = plus.android.importClass("com.cnnet.otc.health.activities.DetectBle4Activity");
           }
           var intent = new Intent(main, TodoActivity.class);
		   var bundle = new Bundle();
		   //传设备类型和会员号
		   bundle.putString("DEIVCE_TYPE",type);
		   bundle.putString("EXTRA_MEMBER_UNIQUEKEY",username);
           intent.putExtras(bundle);
			main.startActivity(intent);

        }
		</script>
		
	</head>
	<body>
		<header>
			<div class="nvbt" onclick="back();"><div class="iback"></div></div>
			<div class="nvtt">设备连接监测</div>
		</header>
		 
		<div id="dcontent" class="dcontent" style="margin-top: 40px;">
			<!--<br/>
			会员号：<input id="memid" type="text" value="13601812485"/>
			<br/>-->
			
			<button id='showDevicePicker' class="mui-btn mui-btn-block" type='button'>请选择蓝牙设备</button>
			<div id='deviceResult' class="ui-alert"></div>

			<button id='showWifiDevicePicker' class="mui-btn mui-btn-block" type='button'>请选择WIFI设备</button>
			<div id='wifiDeviceResult' class="ui-alert"></div>

			<br/>
		</div>
	</body>
</html>